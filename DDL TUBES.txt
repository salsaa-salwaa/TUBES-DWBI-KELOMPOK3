-- Dimensi Customer
CREATE TABLE dim_customer (
    customer_key SERIAL PRIMARY KEY,
    customer_id VARCHAR(50),
    customer_unique_id VARCHAR(50),
    customer_city VARCHAR(100),
    customer_state VARCHAR(10)
);

-- Dimensi Product
CREATE TABLE dim_product (
    product_key SERIAL PRIMARY KEY,
    product_id VARCHAR(50),
    product_category VARCHAR(100)
);

-- Dimensi Seller
CREATE TABLE dim_seller (
    seller_key SERIAL PRIMARY KEY,
    seller_id VARCHAR(50),
    seller_city VARCHAR(100),
    seller_state VARCHAR(10)
);

-- Dimensi Date 
CREATE TABLE dim_date (
    date_id DATE PRIMARY KEY, 
    day INT(11),
    month INT(11),
    quarter INT(11),
    year INT(11)
);

-- fact review
CREATE TABLE fact_review (
    review_key SERIAL PRIMARY KEY,
    review_id VARCHAR(50),
    order_id VARCHAR(50),
    customer_key BIGINT UNSIGNED,
    review_date DATE,
    review_score INT(11),

    CONSTRAINT fk_review_customer FOREIGN KEY (customer_key) 
        REFERENCES dim_customer(customer_key),
    CONSTRAINT fk_review_date FOREIGN KEY (review_date) 
        REFERENCES dim_date(date_id)
);

--fact order item
CREATE TABLE fact_order_item (
    order_item_key SERIAL PRIMARY KEY,
    order_id VARCHAR(50),
    order_item_id INT(11),
    price DECIMAL(10,2),
    freight_value DECIMAL(10,2),
    total DECIMAL(10,2),
    order_date DATE,
    customer_key BIGINT UNSIGNED,
    product_key BIGINT UNSIGNED,
    seller_key BIGINT UNSIGNED,

    -- 4 Foreign Key Constraints
    CONSTRAINT fk_item_date FOREIGN KEY (order_date) 
        REFERENCES dim_date(date_id),
    CONSTRAINT fk_item_customer FOREIGN KEY (customer_key) 
        REFERENCES dim_customer(customer_key),
    CONSTRAINT fk_item_product FOREIGN KEY (product_key) 
        REFERENCES dim_product(product_key),
    CONSTRAINT fk_item_seller FOREIGN KEY (seller_key) 
        REFERENCES dim_seller(seller_key)
);